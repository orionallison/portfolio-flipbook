<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Portfolio Flipbook</title>

  <!-- CSS -->
  <link rel="stylesheet" href="flipbook.css">

  <!-- jQuery (required for Turn.js) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

  <!-- Turn.js -->
  <script src="turnjs/turn.min.js"></script>
</head>

<body>

  <div id="flipbook"></div>

  <script>
  window.onload = function() {
    const totalPages = 28;
    const flipbook = document.getElementById('flipbook');

    // Clear old content
    flipbook.innerHTML = '';

    // Generate pages
    for (let i = 0; i < totalPages; i++) {
      const div = document.createElement('div');
      div.className = 'page';

      const img = document.createElement('img');
      img.src = `pages/page-${String(i).padStart(3, '0')}.png`;
      img.alt = `Page ${i + 1}`;

      div.appendChild(img);
      flipbook.appendChild(div);
    }

    // Initialize Turn.js only if not already initialized
    if (!$('#flipbook').data('turn')) {
      $('#flipbook').turn({
        width: Math.min(window.innerWidth * 0.95, 1000), // responsive width
        height: Math.min(window.innerWidth * 0.95, 1000) * (607 / 1000), // maintain aspect ratio
        autoCenter: true,
        display: 'double', // show spreads
        gradients: true,
        acceleration: true,
        elevation: 50
      });

      // Keyboard navigation
      $(document).keydown(function(e) {
        if (e.key === "ArrowRight") $('#flipbook').turn('next');
        if (e.key === "ArrowLeft") $('#flipbook').turn('previous');
      });

      // Swipe/edge click for mobile
      let startX = 0;
      flipbook.addEventListener('touchstart', e => startX = e.touches[0].clientX);
      flipbook.addEventListener('touchend', e => {
        const diff = e.changedTouches[0].clientX - startX;
        if (diff > 50) $('#flipbook').turn('previous'); // swipe right
        if (diff < -50) $('#flipbook').turn('next');    // swipe left
      });

      // Click edges
      flipbook.addEventListener('click', e => {
        const rect = flipbook.getBoundingClientRect();
        if (e.clientX < rect.left + 0.2 * rect.width) $('#flipbook').turn('previous');
        if (e.clientX > rect.right - 0.2 * rect.width) $('#flipbook').turn('next');
      });
    }

    // Recalculate on resize
    window.addEventListener('resize', () => {
      const w = Math.min(window.innerWidth * 0.95, 1000);
      const h = w * (607 / 1000);
      $('#flipbook').turn('size', w, h);
    });
  };
  </script>

</body>
</html>
