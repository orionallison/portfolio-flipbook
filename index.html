<script>
const totalPages = 28;

for (let i = 0; i < totalPages; i++) {
  const pageNumber = String(i).padStart(3, '0');
  const page = document.createElement('div');
  page.className = 'page';

  const img = document.createElement('img');
  img.src = `pages/page-${pageNumber}.png`;
  img.alt = `Page ${i + 1}`;

  page.appendChild(img);
  document.getElementById('flipbook').appendChild(page);
}

function initFlipbook() {
  const container = $('#flipbook');
  const parentWidth = container.parent().width();
  const aspectRatio = 1000 / 607;
  const height = parentWidth / aspectRatio;

  // Determine display mode based on screen width
  const displayMode = (parentWidth < 800) ? 'single' : 'double';

  container.turn({
    width: parentWidth,
    height: height,
    autoCenter: true,
    display: displayMode,
    gradients: true,
    acceleration: true
  });
}

$(window).on('load resize', function() {
  if ($('#flipbook').data('turn')) {
    $('#flipbook').turn('destroy').empty(); // destroy previous instance
  }
  initFlipbook();
});

// Keyboard navigation: always advance one page at a time
$(document).keydown(function(e) {
  if ($('#flipbook').data('turn')) {
    if (e.key === "ArrowRight") {
      $('#flipbook').turn('next');
    } else if (e.key === "ArrowLeft") {
      $('#flipbook').turn('previous');
    }
  }
});
</script>
